<!DOCTYPE html>
<html class="scroll-smooth" lang="en">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>Musa | Free Expresso</title>

  <link href="https://fonts.googleapis.com" rel="preconnect"/>
  <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&amp;family=Playfair+Display:ital,wght@0,400;0,700;1,400&amp;display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet"/>
  <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>

  <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            primary: "#E97B3C",
            "background-light": "#c1c2af",
            "background-dark": "#1A1614",
            "accent-cream": "#9D9F85",
          },
          fontFamily: {
            display: ["'Playfair Display'", "serif"],
            sans: ["'Outfit'", "sans-serif"],
          },
          borderRadius: {
            DEFAULT: "1.5rem",
            'large': "3rem",
          },
        },
      },
    };
  </script>

  <script>
    const prefersDarkScheme = window.matchMedia("(prefers-color-scheme: dark)");
    const applyThemePreference = () => {
      document.documentElement.classList.toggle("dark", prefersDarkScheme.matches);
    };
    applyThemePreference();
    prefersDarkScheme.addEventListener("change", applyThemePreference);
  </script>

  <style>
    .organic-mask { clip-path: url(#wavy-mask); }
    .wavy-border { border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%; }
    .wavy-border-alt { border-radius: 30% 70% 70% 30% / 50% 60% 40% 50%; }

    [data-marquee-track]{
      display: flex;
      width: max-content;
      will-change: transform;
      animation: none;
    }
    @keyframes marquee {
      to { transform: translate3d(calc(-1 * var(--marquee-distance, 0px)), 0, 0); }
    }
  </style>

  <style>
    /* overlay default (closed) */
    [data-panel-overlay]{
      opacity: 0 !important;
      pointer-events: none !important;
      transition: opacity 300ms ease;
    }

    /* overlay open */
    [data-panel-overlay].footer-panel-open{
      opacity: 1 !important;
      pointer-events: auto !important;
    }

    /* panel slide + sizing */
    [data-panel-body]{
      transform: translateY(100%);
      max-height: 75vh;
      transition:
        transform 300ms ease,
        max-height 650ms cubic-bezier(.22,1,.36,1),
        border-radius 650ms cubic-bezier(.22,1,.36,1);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      will-change: transform, max-height;
    }
    [data-panel-overlay].footer-panel-open [data-panel-body]{
      transform: translateY(0);
    }

    /* expand to full height once user scrolls inside */
    [data-panel-body].panel-expanded{
      max-height: 100vh;
      border-top-left-radius: 0;
      border-top-right-radius: 0;
    }

    /* sticky header + scroll area */
    [data-panel-header]{
      position: sticky;
      top: 0;
      z-index: 10;
      background: inherit;
      backdrop-filter: blur(8px);
    }

    [data-panel-scroll]{
      flex: 1;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }
  </style>
</head>

<body class="bg-background-light dark:bg-background-dark text-slate-800 dark:text-slate-100 font-sans transition-colors duration-300">
  <svg class="absolute" height="0" width="0">
    <defs>
      <clipPath clipPathUnits="objectBoundingBox" id="wavy-mask">
        <path d="M0.1,0.05 C0.3,0 0.7,0 0.9,0.1 C1,0.2 1,0.5 0.9,0.8 C0.8,1 0.5,1 0.2,0.9 C0,0.8 0,0.5 0.1,0.05 Z"></path>
      </clipPath>
    </defs>
  </svg>

  <!-- HEADER (EXACTLY as main page) -->
  <nav class="fixed w-full z-50 bg-background-light/80 dark:bg-background-dark/80 backdrop-blur-md border-b border-primary/10">
    <div class="max-w-7xl mx-auto px-6 h-20 flex items-center justify-between">
      <div class="flex items-center gap-2">
        <a href="https://www.musabytania.com/" class="inline-flex items-center" aria-label="Go to Musa home">
  <img alt="Musa Logo" class="h-20 w-20 object-contain" src="https://iftimie2002.github.io/musawebsite/imgmusa/logomusa1 Small.png"/>
</a>

      </div>
      <div class="flex items-center gap-4">
        <button class="p-2 rounded-full bg-accent-cream dark:bg-slate-800 text-primary" onclick="document.documentElement.classList.toggle('dark')">
          <span class="material-symbols-outlined block dark:hidden">dark_mode</span>
          <span class="material-symbols-outlined hidden dark:block">light_mode</span>
        </button>
        <a href="tel:+351933291105" class="hidden sm:block bg-primary hover:bg-opacity-90 text-white px-6 py-2.5 rounded-full font-semibold transition-all shadow-lg shadow-primary/20">
          Book a Table
        </a>
      </div>
    </div>
  </nav>

  <!-- SIMPLE PROMO CONTENT (plain) -->
  <main class="pt-32 pb-20">
    <div class="max-w-3xl mx-auto px-6">
      <div class="bg-white/60 dark:bg-slate-900/60 backdrop-blur rounded-large border border-primary/10 p-10 md:p-14 text-center shadow-xl">
        <h1 class="font-display text-4xl md:text-6xl font-bold leading-tight">
          1 Tagged Photo / Instagram Story
        </h1>
        <p class="font-display italic text-primary text-3xl md:text-4xl mt-6">
          = 1 Free Expresso ☕
        </p>
        <p class="text-slate-600 dark:text-slate-400 max-w-sm mb-6">
            <strong>* Limited to 1 expresso per person</strong>.
          </p>

        <div class="mt-10 flex justify-center">
          <a href="https://www.instagram.com/musa_carvoeiro/" target="_blank" rel="noopener noreferrer"
             class="bg-primary text-white px-8 py-4 rounded-full font-bold text-lg hover:shadow-xl hover:-translate-y-1 transition-all inline-flex items-center gap-3">
            <svg class="w-6 h-6 fill-current" viewBox="0 0 24 24">
              <path d="M12 2.163c3.204 0 3.584.012 4.85.07 1.366.062 2.633.332 3.608 1.308.975.975 1.245 2.242 1.308 3.608.058 1.266.07 1.646.07 4.85s-.012 3.584-.07 4.85c-.063 1.366-.333 2.633-1.308 3.608-.975.975-2.242 1.246-3.608 1.308-1.266.058-1.646.07-4.85.07s-3.584-.012-4.85-.07c-1.366-.062-2.633-.332-3.608-1.308-.975-.975-1.245-2.242-1.308-3.608-.058-1.266-.07-1.646-.07-4.85s.012-3.584.07-4.85c.062-1.366.332-2.633 1.308-3.608.975-.975 2.242-1.245 3.608-1.308 1.266-.058 1.646-.07 4.85-.07zm0 3.675a6.162 6.162 0 1 0 0 12.324 6.162 6.162 0 0 0 0-12.324zm0 10.162a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm6.406-11.845a1.44 1.44 0 1 0 0 2.88 1.44 1.44 0 0 0 0-2.88z"/>
            </svg>
            Open Instagram
          </a>
        </div>
      </div>
    </div>

    <!-- dummy anchors so header links don't error/feel broken -->
    <div id="menu"></div>
    <div id="reservations"></div>
    <div id="story"></div>
  </main>

  <!-- FOOTER (EXACTLY as main page) -->
  <footer class="bg-accent-cream dark:bg-slate-900 pt-20 pb-10 border-t border-primary/10" id="location">
    <div class="max-w-7xl mx-auto px-6">
      <div class="grid md:grid-cols-4 gap-12 mb-20">
        <div class="col-span-2">
          <div class="flex items-center gap-2 mb-6">
            <img alt="Musa Logo" class="h-20 w-20 object-contain" src="https://iftimie2002.github.io/musawebsite/imgmusa/logomusa1 Small.png"/>
          </div>
          <p class="text-slate-600 dark:text-slate-400 max-w-sm mb-6">
            <strong>This is Your Sign to Brunch.</strong> <br>Located in the heart of Carvoeiro, <br>Musa offers a cozy atmosphere, fresh ingredients, and a menu crafted with love.<br>Join us for an unforgettable <i>Brunching</i> experience.
          </p>
          <div class="flex gap-4">
            <a href="https://www.instagram.com/musa_carvoeiro/" target="_blank" rel="noopener noreferrer"
               class="w-10 h-10 rounded-full bg-primary/10 text-primary flex items-center justify-center hover:bg-primary hover:text-white transition-all">
              <svg class="w-5 h-5 fill-current" viewBox="0 0 24 24">
                <path d="M12 2.163c3.204 0 3.584.012 4.85.07 1.366.062 2.633.332 3.608 1.308.975.975 1.245 2.242 1.308 3.608.058 1.266.07 1.646.07 4.85s-.012 3.584-.07 4.85c-.063 1.366-.333 2.633-1.308 3.608-.975.975-2.242 1.246-3.608 1.308-1.266.058-1.646.07-4.85.07s-3.584-.012-4.85-.07c-1.366-.062-2.633-.332-3.608-1.308-.975-.975-1.245-2.242-1.308-3.608-.058-1.266-.07-1.646-.07-4.85s.012-3.584.07-4.85c.062-1.366.332-2.633 1.308-3.608.975-.975 2.242-1.245 3.608-1.308 1.266-.058 1.646-.07 4.85-.07zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948s.014 3.667.072 4.947c.2 4.337 2.62 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072s3.667-.014 4.947-.072c4.354-.2 6.782-2.618 6.979-6.98.059-1.28-.073-1.689-.073-4.948s.014-3.667-.072-4.947c-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"></path>
              </svg>
            </a>
          </div>
        </div>

        <div>
          <h4 class="font-bold mb-6 text-primary uppercase tracking-wider text-sm">Location</h4>
          <iframe
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d318.900821204506!2d-8.4692322!3d37.1001205!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0xd1ad755f1fc8329:0x8f30e671060f9860!2sRestaurante%20Musa!5e0!3m2!1spt-PT!2spt!4v1760000000000"
            width="100%"
            height="450"
            style="border:0;"
            allowfullscreen=""
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade">
          </iframe>
        </div>

        <div>
          <h4 class="font-bold mb-6 text-primary uppercase tracking-wider text-sm">Hours</h4>
          <ul class="text-slate-600 dark:text-slate-400 space-y-2">
            <li>Tue - Sat: <strong>9am - 4pm</strong></li>
            <li>Sun & Mon: <strong>We're Resting</strong></li>
          </ul>
        </div>
      </div>

      <div class="border-t border-primary/10 pt-10 flex flex-col md:flex-row justify-between items-center gap-4 text-sm text-slate-500">
        <p>© 2026 Musa by Tania© Brunch. All Rights Reserved.</p>
        <div class="flex gap-6">
          <button class="hover:text-primary transition-colors" data-panel="privacy" type="button">Privacy Policy</button>
          <button class="hover:text-primary transition-colors" data-panel="terms" type="button">Terms of Service</button>
        </div>
      </div>
    </div>
  </footer>

  <div class="fixed inset-0 bg-slate-900/40 transition-opacity duration-300 flex items-end justify-center z-[60]" data-panel-overlay>
    <div class="bg-white dark:bg-slate-900 w-full max-w-2xl rounded-t-[2.5rem] transition-transform duration-300" data-panel-body>
      <div class="px-8 pt-8 pb-4 border-b border-primary/10" data-panel-header>
        <div class="flex items-center justify-between">
          <h3 class="font-display text-2xl md:text-3xl font-bold" data-panel-title></h3>
          <button class="text-slate-500 hover:text-primary transition-colors" data-panel-close type="button" aria-label="Close">
            <span class="material-symbols-outlined">close</span>
          </button>
        </div>
      </div>

      <div class="px-8 pb-10 text-slate-600 dark:text-slate-400 leading-relaxed space-y-4 text-base md:text-lg" data-panel-scroll>
        <div data-panel-content></div>
      </div>
    </div>
  </div>

  <style>
    @keyframes spin-slow { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    .animate-spin-slow { animation: spin-slow 15s linear infinite; }
  </style>

  <script>
    const footerOverlay = document.querySelector("[data-panel-overlay]");
    const panelBody = document.querySelector("[data-panel-body]");
    const panelTitle = document.querySelector("[data-panel-title]");
    const panelContent = document.querySelector("[data-panel-content]");
    const panelClose = document.querySelector("[data-panel-close]");
    const panelScroll = document.querySelector("[data-panel-scroll]");

    const panelText = {
      privacy: {
        title: "Privacy Policy",
        body: `<p><strong>Restaurant Musa</strong><br>
        <strong>Last updated:</strong> January 12, 2026</p>

        <p>
          Restaurant Musa is committed to protecting the privacy and personal data of its customers,
          website visitors, and other data subjects, in full compliance with Regulation (EU) 2016/679
          (GDPR) and all other applicable data protection legislation.
        </p>

        <p>
          This Privacy Policy explains who we are, which personal data we collect, how we process it,
          with whom we share it, how long we retain it, and which rights you have as a data subject.
        </p>

        <h3>1. Data Controller</h3>
        <p>
          <strong>Business name:</strong> Tania Teixeira Gravito Vala<br>
          <strong>Tax ID (NIF):</strong> 224273140<br>
          <strong>Registered address:</strong> Rua do Barranco, Loja I, 8400-500 Lagoa-Carvoeiro<br>
          <strong>Contact:</strong> +351 933 291 105
        </p>

        <h3>2. Personal Data We Collect</h3>
        <ul>
          <li><strong>Identification and contact data:</strong> first name, last name, phone number, email address</li>
          <li><strong>Reservation data:</strong> date, time, number of guests, special requests (e.g. allergies, birthdays, when voluntarily provided)</li>
          <li><strong>Payment data:</strong> strictly necessary data processed by PCI-DSS certified providers (we do not store full card details)</li>
          <li><strong>Browsing data:</strong> IP address, device type, browser, pages visited (via cookies)</li>
          <li><strong>Other data:</strong> information voluntarily provided (comments, suggestions, event participation)</li>
        </ul>

        <h3>3. Purposes and Legal Basis</h3>
        <ul>
          <li><strong>Table reservations:</strong> performance of a contract (mandatory)</li>
          <li><strong>Take-away / delivery orders:</strong> performance of a contract (mandatory)</li>
          <li><strong>Contact requests:</strong> legitimate interest or consent</li>
          <li><strong>Marketing communications:</strong> consent</li>
          <li><strong>Legal obligations (e.g. invoicing):</strong> legal obligation</li>
          <li><strong>Website improvement & analytics:</strong> legitimate interest</li>
          <li><strong>Security and fraud prevention:</strong> legitimate interest</li>
        </ul>

        <h3>4. Data Retention</h3>
        <ul>
          <li><strong>Reservation data:</strong> up to 30 days after the reservation date</li>
          <li><strong>Newsletter data:</strong> until consent is withdrawn</li>
          <li><strong>Invoicing data:</strong> 10 years</li>
          <li><strong>Browsing data:</strong> in accordance with the Cookie Policy (up to 13 months)</li>
        </ul>

        <h3>5. Data Sharing</h3>
        <p>
          Personal data may be shared with judicial, tax, or regulatory authorities when legally required.
          We do not sell or share personal data with third parties for direct marketing purposes.
        </p>

        <h3>6. Your Rights</h3>
        <ul>
          <li>Right of access</li>
          <li>Right to rectification</li>
          <li>Right to erasure (“right to be forgotten”)</li>
          <li>Right to restriction of processing</li>
          <li>Right to data portability</li>
          <li>Right to object to processing</li>
          <li>Right to withdraw consent</li>
          <li>Right to lodge a complaint with the CNPD (www.cnpd.pt)</li>
        </ul>

        <p>
          To exercise your rights, contact us at <strong>+351 933 291 105</strong>.
          We will respond within 30 days, except in cases of particular complexity.
        </p>

        <h3>7. Security</h3>
        <p>
          We apply appropriate technical and organisational measures to protect personal data against
          loss, misuse, alteration, or unauthorised access.
        </p>

        <h3>8. Policy Updates</h3>
        <p>
          This Privacy Policy may be updated periodically. The latest version will always be available
          on this page with the corresponding update date.
        </p>

        <h3>9. Contact</h3>
        <p>
          <strong>Address:</strong> Rua do Barranco, Loja I, 8400-500 Lagoa-Carvoeiro
        </p>

        <p>
          Thank you for trusting Restaurant Musa.<br>
          Your privacy is important to us.
        </p>
  `,
      },
      terms: {
        title: "Terms of Service",
        body: `<p><strong>Restaurant Musa</strong><br>
      <strong>Last updated:</strong> January 12, 2026</p>

      <p>
        Welcome to the official website of Restaurant Musa (hereinafter referred to as the
        “Website”), accessible at www.musa-restaurante.pt (or any domain that may be used).
      </p>

      <p>
        By accessing and using this Website, you fully and unreservedly accept these Terms
        and Conditions of Use. If you do not agree with any of the terms set out below,
        please do not use the Website.
      </p>

      <h3>1. Responsible Entity</h3>
      <p>
        <strong>Business name:</strong> Tania Teixeira Gravito Vala<br>
        <strong>Tax ID (NIF):</strong> 224273140<br>
        <strong>Address:</strong> Rua do Barranco, Loja I, 8400-500 Lagoa-Carvoeiro<br>
        <strong>Contact:</strong> +351 933 291 105
      </p>

      <h3>2. Purpose of the Website</h3>
      <p>The Website is primarily intended to:</p>
      <ul>
        <li>Present Restaurant Musa, its history, team, philosophy, and space</li>
        <li>Provide information about the menu, opening hours, and contacts</li>
        <li>Allow table reservations (when available)</li>
        <li>Occasionally promote events, offers, and news</li>
      </ul>

      <h3>3. Use of the Website</h3>
      <p>
        Users agree to use the Website lawfully, responsibly, honestly, and in good faith.
      </p>
      <p>It is strictly prohibited to:</p>
      <ul>
        <li>Use the Website for illegal purposes or in violation of third-party rights</li>
        <li>Introduce or spread viruses or any other malicious code</li>
        <li>Attempt unauthorised access to restricted areas of the Website</li>
        <li>Carry out reverse engineering, decompilation, or attempts to discover source code</li>
        <li>Reproduce, distribute, or commercially exploit content without prior authorisation</li>
      </ul>

      <h3>4. Table Reservations (when applicable)</h3>
      <ul>
        <li>Reservations made through the Website are considered reservation requests and do not constitute a binding contract</li>
        <li>Restaurant Musa reserves the right to confirm, modify, or cancel reservations based on actual availability or exceptional circumstances</li>
        <li>No-shows without prior notice of at least 2–4 hours (as indicated at the time of booking) may result in a fee or restrictions on future reservations, in accordance with restaurant policy</li>
        <li>Personal data collected during the reservation process is used exclusively for reservation management</li>
      </ul>

      <h3>5. Online Orders / Take-away / Delivery (if available)</h3>
      <ul>
        <li>Prices displayed include VAT at the legally applicable rate</li>
        <li>Restaurant Musa reserves the right to change prices, products, and promotional conditions without prior notice</li>
        <li>An order is only considered accepted after explicit confirmation by the Restaurant (via email, SMS, or WhatsApp)</li>
        <li>If an item is unavailable, the customer will be contacted to propose alternatives or a refund</li>
        <li>Estimated delivery times are indicative only</li>
      </ul>

      <h3>6. Intellectual Property</h3>
      <p>
        All content on the Website (texts, images, photographs, logo, design, software, etc.)
        is the property of Restaurant Musa or is duly licensed.
        Any reproduction, modification, transmission, publication, or other form of use,
        in whole or in part, without prior written authorisation is strictly prohibited.
      </p>

      <h3>7. Liability</h3>
      <p>Restaurant Musa shall not be liable for:</p>
      <ul>
        <li>Direct or indirect damages resulting from improper use of the Website</li>
        <li>Temporary unavailability of the Website due to technical issues, maintenance, or force majeure</li>
        <li>Content of external hyperlinks to third-party websites</li>
      </ul>

      <h3>8. Personal Data Processing</h3>
      <p>
        Personal data collected through the Website is processed in accordance with
        Regulation (EU) 2016/679 (GDPR) and applicable legislation.
      </p>
      <p>
        Please consult our <strong>Privacy Policy</strong> for detailed information regarding
        the data controller, purposes, legal basis, retention periods, and data subject rights.
      </p>

      <h3>9. Changes to the Terms</h3>
      <p>
        Restaurant Musa reserves the right to amend these Terms and Conditions at any time,
        without prior notice. Changes take effect upon publication on the Website.
        Continued use of the Website after publication constitutes acceptance of the updated terms.
      </p>

      <h3>10. Applicable Law and Jurisdiction</h3>
      <p>
        These Terms and Conditions are governed by Portuguese law.
        For the resolution of any disputes arising from the use of the Website,
        the courts of the Lisbon District shall have exclusive jurisdiction,
        with express waiver of any other.
      </p>

      <p>
        <strong>Contact for matters related to these Terms and Conditions:</strong><br>
        info@musa-restaurante.pt
      </p>

      <p>
        Thank you for visiting Restaurant Musa.<br>
        We look forward to welcoming you soon.
      </p>
  `,
      },
    };

    const openPanel = (key) => {
      const content = panelText[key];
      if (!content) return;

      panelTitle.textContent = content.title;
      panelContent.innerHTML = content.body;

      footerOverlay.classList.add("footer-panel-open");
      panelBody.classList.remove("panel-expanded");
      panelScroll.scrollTop = 0;

      document.body.style.overflow = "hidden";
    };

    const closePanel = () => {
      footerOverlay.classList.remove("footer-panel-open");
      panelBody.classList.remove("panel-expanded");
      document.body.style.overflow = "";
    };

    document.querySelectorAll("[data-panel]").forEach((button) => {
      button.addEventListener("click", () => openPanel(button.dataset.panel));
    });

    footerOverlay.addEventListener("click", (e) => {
      if (e.target === footerOverlay) closePanel();
    });

    panelClose.addEventListener("click", closePanel);

    const EXPAND_AT = 200;
    panelScroll.addEventListener(
      "scroll",
      () => {
        if (panelScroll.scrollTop > EXPAND_AT) panelBody.classList.add("panel-expanded");
        else panelBody.classList.remove("panel-expanded");
      },
      { passive: true }
    );

    footerOverlay.addEventListener(
      "wheel",
      (e) => {
        if (!footerOverlay.classList.contains("footer-panel-open")) return;
        if (panelBody.contains(e.target)) return;
        closePanel();
        window.scrollBy({ top: e.deltaY, left: 0, behavior: "auto" });
      },
      { passive: true }
    );

    const WHEEL_CLOSE_DISTANCE = 220;
    const WHEEL_CLOSE_SINGLE = 90;
    const WHEEL_RESET_GAP_MS = 140;

    let wheelPull = 0;
    let wheelLastTs = 0;

    panelScroll.addEventListener(
      "wheel",
      (e) => {
        if (!footerOverlay.classList.contains("footer-panel-open")) return;

        if (panelScroll.scrollTop > 6) {
          wheelPull = 0;
          return;
        }

        if (e.deltaY >= 0) {
          wheelPull = 0;
          return;
        }

        const now = performance.now();
        if (now - wheelLastTs > WHEEL_RESET_GAP_MS) wheelPull = 0;
        wheelLastTs = now;

        const pull = -e.deltaY;
        wheelPull += pull;

        if (pull >= WHEEL_CLOSE_SINGLE || wheelPull >= WHEEL_CLOSE_DISTANCE) {
          closePanel();
          wheelPull = 0;
        }
      },
      { passive: true }
    );

    let startY = null;

    footerOverlay.addEventListener(
      "touchstart",
      (e) => {
        if (!footerOverlay.classList.contains("footer-panel-open")) return;
        if (e.target !== footerOverlay) return;
        startY = e.touches[0].clientY;
      },
      { passive: true }
    );

    footerOverlay.addEventListener(
      "touchmove",
      (e) => {
        if (startY == null) return;
        if (e.target !== footerOverlay) return;

        const dy = e.touches[0].clientY - startY;
        if (Math.abs(dy) > 18) {
          closePanel();
          window.scrollBy(0, -dy);
          startY = null;
        }
      },
      { passive: true }
    );

    footerOverlay.addEventListener(
      "touchend",
      () => { startY = null; },
      { passive: true }
    );

    const TOUCH_CLOSE_DIST = 140;
    const TOUCH_CLOSE_SPEED = 0.40;
    const TOP_SLOP = 6;

    let touchStartY = null;
    let touchStartT = null;

    panelScroll.addEventListener(
      "touchstart",
      (e) => {
        if (!footerOverlay.classList.contains("footer-panel-open")) return;
        touchStartY = e.touches[0].clientY;
        touchStartT = performance.now();
      },
      { passive: true }
    );

    panelScroll.addEventListener(
      "touchmove",
      (e) => {
        if (touchStartY == null) return;
        if (panelScroll.scrollTop > TOP_SLOP) return;

        const y = e.touches[0].clientY;
        const dy = y - touchStartY;
        if (dy <= 0) return;

        const dt = performance.now() - touchStartT;
        const v = dy / Math.max(dt, 1);

        if (dy >= TOUCH_CLOSE_DIST && v >= TOUCH_CLOSE_SPEED) {
          closePanel();
          touchStartY = null;
          touchStartT = null;
        }
      },
      { passive: true }
    );

    panelScroll.addEventListener(
      "touchend",
      () => { touchStartY = null; touchStartT = null; },
      { passive: true }
    );
  </script>

  <!-- Optional: keep the same marquee script (safe even if no marquee exists) -->
  <script>
    (() => {
      const marquee = document.querySelector("[data-marquee]");
      if (!marquee) return;

      const track = marquee.querySelector("[data-marquee-track]");
      const originalGroup = marquee.querySelector("[data-marquee-group]");
      if (!track || !originalGroup) return;

      const SPEED_PX_PER_SEC = 150;
      let rafId = null;

      const restartAnimation = (seconds) => {
        track.style.animation = "none";
        track.offsetHeight;
        track.style.animation = `marquee ${seconds}s linear infinite`;
      };

      const template = originalGroup.cloneNode(true);

      const build = () => {
        track.innerHTML = "";

        const g1 = template.cloneNode(true);
        track.appendChild(g1);

        const minWidth = marquee.clientWidth * 1.5;
        const templateKids = Array.from(template.children);

        let guard = 0;
        while (g1.scrollWidth < minWidth && guard++ < 200) {
          templateKids.forEach((n) => g1.appendChild(n.cloneNode(true)));
        }

        const g2 = g1.cloneNode(true);
        g2.setAttribute("aria-hidden", "true");
        track.appendChild(g2);

        const distance = g1.scrollWidth;
        if (!distance || distance < 10) {
          rafId = requestAnimationFrame(build);
          return;
        }

        track.style.setProperty("--marquee-distance", distance + "px");
        restartAnimation(distance / SPEED_PX_PER_SEC);
      };

      const scheduleBuild = () => {
        if (rafId) cancelAnimationFrame(rafId);
        rafId = requestAnimationFrame(() => requestAnimationFrame(build));
      };

      if (document.fonts && document.fonts.ready) {
        document.fonts.ready.then(scheduleBuild);
      } else {
        scheduleBuild();
      }

      let t;
      window.addEventListener("resize", () => {
        clearTimeout(t);
        t = setTimeout(scheduleBuild, 120);
      });

      document.addEventListener("visibilitychange", () => {
        if (!document.hidden) scheduleBuild();
      });
    })();
  </script>
</body>
</html>
